using NUnit.Framework;

using AdventOfCode.Solvers;

namespace AdventOfCode.Tests {
  public class Day10SolverTests {

    [TestCase("Best asteroid (3,4) can view 8 asteroids.", new string[] {
        ".#..#",
        ".....",
        "#####",
        "....#",
        "...##"
    })]
    [TestCase("Best asteroid (5,8) can view 33 asteroids.", new string[] {
      "......#.#.",
      "#..#.#....",
      "..#######.",
      ".#.#.###..",
      ".#..#.....",
      "..#....#.#",
      "#..#....#.",
      ".##.#..###",
      "##...#..#.",
      ".#....####"
    })]
    [TestCase("Best asteroid (11,13) can view 210 asteroids.", new string[] {
        ".#..##.###...#######",
        "##.############..##.",
        ".#.######.########.#",
        ".###.#######.####.#.",
        "#####.##.#.##.###.##",
        "..#####..#.#########",
        "####################",
        "#.####....###.#.#.##",
        "##.#################",
        "#####.##.###..####..",
        "..######..##.#######",
        "####.##.####...##..#",
        ".#####..#.######.###",
        "##...#.##########...",
        "#.##########.#######",
        ".####.#.###.###.#.##",
        "....##.##.###..#####",
        ".#.#.###########.###",
        "#.#.#.#####.####.###",
        "###.##.####.##.#..##"
    })]
    public void TestPartOne(string expected, string[] input) {
      Solver s = new Day10Solver();
      string result = s.SolvePartOne(input);
      Assert.That(result, Is.EqualTo(expected));
    }

     [TestCase("801", 1, 8, 3, new string[] {
       ".#....#####...#..",
       "##...##.#####..##",
       "##...#...#.#####.",
       "..#.....#...###..",
       "..#.#.....#....##"
     })]
     [TestCase("802", 200, 11, 13, new string[] {
        ".#..##.###...#######",
        "##.############..##.",
        ".#.######.########.#",
        ".###.#######.####.#.",
        "#####.##.#.##.###.##",
        "..#####..#.#########",
        "####################",
        "#.####....###.#.#.##",
        "##.#################",
        "#####.##.###..####..",
        "..######..##.#######",
        "####.##.####...##..#",
        ".#####..#.######.###",
        "##...#.##########...",
        "#.##########.#######",
        ".####.#.###.###.#.##",
        "....##.##.###..#####",
        ".#.#.###########.###",
        "#.#.#.#####.####.###",
        "###.##.####.##.#..##"
    })]
    public void TestPartTwo(string expected, int count, int x, int y, string[] input) {
      Day10Solver s = new Day10Solver();
      string result = s.SolvePartTwo(input, count, x, y);
      Assert.That(result, Is.EqualTo(expected));
    }
  }
}
